# lesson #3 - Использование сборщика Gradle

## Этап №1 - Инициализация проекта

Перейдите в директорию третьего урока `cd ./lessons/lesson_2`

запустите команду:

```sh
gradle init
```

Данная команда выдаст несколько вопросов:

I) Select type of project to generate - Выберите Groovy
II) Select build script DSL - Выберите Groovy
III) Project name - оставьте по умолчанию (имя текущей директории)
IV) Generate build using new APIs and behavior (some features may change in the next minor release) - выберите no

Затем вы должны увидеть сообщение - `BUILD SUCCESSFUL`.

Командой gradle init вы создали новый проект с использованием системы сборки Gradle. Вот описание каждого из созданных файлов и директорий:

`settings.gradle`: Этот файл содержит конфигурацию для Gradle и определяет, какие модули или проекты должны быть включены в сборку. В нем можно указать зависимости между модулями проекта и настроить другие параметры Gradle.

`gradlew` (или `gradlew.bat` в Windows): Это скрипт для запуска сборки проекта с использованием Gradle Wrapper. Gradle Wrapper позволяет выполнять сборку проекта без установки Gradle на вашей системе. Вместо этого, Gradle Wrapper загружает нужную версию Gradle автоматически при первом запуске. [Wrapper Gradle](https://docs.gradle.org/current/userguide/gradle_wrapper.html)

`build.gradle`: Этот файл содержит скрипт сборки проекта на Gradle. Здесь вы можете определить зависимости, настроить задачи сборки, плагины и другие параметры проекта. build.gradle - основной файл конфигурации проекта, который вы редактируете для определения поведения сборки.

`.gitattributes`: Этот файл содержит настройки для системы контроля версий Git. Он определяет, какие файлы и расширения должны быть проигнорированы, какой должна быть обработка окончаний строк и другие параметры для Git.

`.gitignore`: Этот файл содержит список файлов и директорий, которые Git должен игнорировать при отслеживании изменений. Например, вы можете указать, чтобы Git игнорировал временные файлы, скомпилированный код или файлы конфигурации, которые не должны быть включены в репозиторий.

`gradle` (директория): Это директория, которая содержит файлы и каталоги, используемые Gradle для работы. Внутри этой директории могут находиться файлы с расширением .jar, кэш-файлы и другие временные файлы, связанные со сборкой проекта.

`.gradle` (директория): Это директория, используемая Gradle для хранения своих файлов и кэша. Она содержит временные файлы, закэшированные зависимости и другие данные, которые Gradle использует при сборке проекта. Обычно эта директория автоматически создается Gradle при выполнении сборки и не требует прямого вмешательства со стороны разработчика.

Каждый из этих файлов и директорий имеет свою роль в системе сборки Gradle и помогает вам настроить и выполнять сборку проекта с помощью Gradle.

## Этап №2 - Просмотр доступных команд сборщика Gradle

Запустите команду `gradle tasks`. Вы увидите список доступных команд gradle. Например `tasks - Displays the tasks runnable from root project 'lesson_3'`

## Этап №3 - Настройка сборки

Откройте файл `build.gradle`. Комментарии в файле можно удалить. Добавьте в файл следующую конфигурацию:

```groovy
plugins {
    id 'java'
}

jar {
    manifest {
        attributes 'Main-Class': 'Demo'
    }
}

java {
    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'
}
```

Вероятнее всего, после сохранения файла `build.gradle` ваша IDE попросит синхронизировать Java classpath/configuration - Согласитесь. Смотрите подробности [здесь](#синхронизация).

Конфигурация, которую вы добавили в файл build.gradle, указывает на применение плагина Gradle с идентификатором 'java'. Подробности смотрите [здесь](#плагины)

После этого запустите команду `gradle tasks` - убедитесь в том, что команд для сборки стало больше. Эти новые команды относятся к языку java. Например `javadoc - Generates Javadoc API documentation for the 'main' feature.`

Так же, в добавленной конфигурации есть секция jar и конкретно свойство manifest. Эта настройка позволит добавлять нужные атрибуты в файл манифеста будущего jar файла.

Так же, параметры sourceCompatibility и targetCompatibility, в секции java, устанавливают версию Java на которой будет запускаться программа. Установите 1.8 - пусть программа запускается даже на самых старых версиях Java.

## Этап №4 - Cборка

Обратите внимание на исходники. Класс Demo.java который мы хотим собрать находится в директории `/src/main/java`. По умолчанию именно от этой директории сборщик начинает сборку проекта.

Запустите команду `gradle build`. Проект, в виде jar, соберется в директорию `build`. Так же создастся папка bin с *.class файлами.

Если вы находитесь в корне проекта, запустите собранную программу при помощи команды:

```sh
java -jar ./lessons/lesson_3/build/libs/lesson_3.jar
```

## Видео

[Gradle tutorial for complete beginners](https://www.youtube.com/watch?v=-dtcEMLNmn0)

## Синхронизация

Когда ваша IDE (среда разработки) просит синхронизировать Java classpath/configuration после сохранения файла build.gradle, это означает, что IDE обнаружила изменения в настройках сборки вашего проекта и предлагает обновить соответствующие настройки в своей конфигурации.

Classpath (путь классов) в Java - это список директорий и JAR-файлов, которые JVM (Java Virtual Machine) использует для поиска загружаемых классов во время выполнения программы. Classpath указывает, где JVM может найти скомпилированные классы и библиотеки, которые ваш проект использует во время выполнения.

В файле build.gradle вы, вероятно, внесли изменения, такие как добавление зависимостей, изменение путей к исходным файлам или настройку других параметров сборки. Когда вы сохраняете этот файл, система сборки Gradle пересчитывает и обновляет свою конфигурацию, включая classpath.

IDE пытается отследить эти изменения и предлагает синхронизировать свою конфигурацию с обновленными настройками сборки. Это позволяет IDE правильно определить пути к классам и библиотекам, которые используются в вашем проекте, чтобы обеспечить корректную поддержку функций, таких как автодополнение кода, проверка ошибок и другие возможности.

Синхронизация Java classpath/configuration обычно происходит автоматически, и вам нужно просто подтвердить или выполнить соответствующую команду в вашей IDE для обновления настроек сборки. Это поможет вашей IDE понять, какие классы и библиотеки доступны в вашем проекте после изменений в файле build.gradle.

## Плагины

Плагины в Gradle представляют собой модули или расширения, которые добавляют дополнительную функциональность к системе сборки. В данном случае, плагин 'java' предоставляет функциональность для разработки проектов на языке Java.

Когда вы добавляете конфигурацию plugins в файл build.gradle и указываете идентификатор 'java', Gradle автоматически загружает и применяет соответствующий плагин. После применения плагина, вы получаете доступ к задачам, настройкам и другим возможностям, связанным с разработкой проекта на Java.

Например, после применения плагина 'java', вы можете использовать задачу compileJava для компиляции исходного кода Java, задачу test для запуска модульных тестов и другие задачи, специфичные для Java-проектов.

В целом, добавление конфигурации plugins с идентификатором 'java' указывает Gradle на использование плагина Java, чтобы вы могли выполнять сборку и разработку своего Java-проекта с помощью системы сборки Gradle.
